imports:
  go: github.com/campbel/run/actions/golang

actions:
  default:
    cmds:
    - shell: run --list

  install:
    desc: "Install Golang"
    cmds:
    - action: go.install_pkg
  
  run:
    desc: "Run a go program"
    deps: [install]
    cmds:
    - shell : echo "Running a go program"
    - action: go.run

  test:
    desc: "Run all go tests"
    deps: [install]
    cmds:
    - action: go.test

  build:
    desc: "Build all go apps"
    deps: [install]
    cmds:
    - action: go.build

  echo:
    desc: "Echo a message"
    vars:
      MESSAGE:
        shell: echo "{{ default "default world" .ARGS.MESSAGE }}"
    cmds:
    - shell: echo "Hello {{ .VARS.MESSAGE }}"

  convoluted_1:
    desc: "A convoluted action"
    deps: [echo]
    cmds:
    - shell: sleep 1 && echo "Hello $MESSAGE 1"
    - shell: sleep 1 && echo "Hello $MESSAGE 2"

  convoluted_2:
    desc: "A convoluted action"
    deps: [convoluted_1]
    cmds:
    - shell: sleep 1 && echo "Hello from me"
    - shell: sleep 1 && zsh -c "repeat 100 echo 'Hello to you'"
    - action: echo
      args: { MESSAGE: "convoluted_2" }
    - shell: sleep 3 && echo "Hello from me again"